

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>generate_mesh_hydrology_ini_from_excel &mdash; MESH-Scripts-PyLib 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="remap_climate_to_ddb" href="remap_climate_to_ddb.html" />
    <link rel="prev" title="generate_mesh_class_ini_from_excel" href="generate_mesh_class_ini_from_excel.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MESH-Scripts-PyLib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">File preparation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Aggregation_vector.html">Aggregate vector subbasins</a></li>
<li class="toctree-l1"><a class="reference internal" href="NetCDFWriter.html">Netcdf writer</a></li>
<li class="toctree-l1"><a class="reference internal" href="convert_ddbnetcdf.html">convert_ddbnetcdf</a></li>
<li class="toctree-l1"><a class="reference internal" href="gdf_edit.html">gdf_edit</a></li>
<li class="toctree-l1"><a class="reference internal" href="gen_streamflow_file.html">gen_streamflow_file</a></li>
<li class="toctree-l1"><a class="reference internal" href="gsde_soil.html">GSDE soil</a></li>
<li class="toctree-l1"><a class="reference internal" href="generate_mesh_class_ini_from_excel.html">generate_mesh_class_ini_from_excel</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">generate_mesh_hydrology_ini_from_excel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel.generate_mesh_hydrology_ini_from_excel"><code class="docutils literal notranslate"><span class="pre">generate_mesh_hydrology_ini_from_excel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="remap_climate_to_ddb.html">remap_climate_to_ddb</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Visualization:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plt_var_vector_setup.html">plt_var_vector_setup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Jupyter Notebooks:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="MESH_StreamflowFilePrep.html">MESH Streamflow File Preparation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MESH-Scripts-PyLib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">generate_mesh_hydrology_ini_from_excel</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/fuadyassin/MESH-Scripts-PyLib/blob/main/docs/source/generate_mesh_hydrology_ini_from_excel.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel">
<span id="generate-mesh-hydrology-ini-from-excel"></span><h1>generate_mesh_hydrology_ini_from_excel<a class="headerlink" href="#module-MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel.generate_mesh_hydrology_ini_from_excel">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel.</span></span><span class="sig-name descname"><span class="pre">generate_mesh_hydrology_ini_from_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MeshHydrology.ini'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hydrology_ini'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/generate_mesh_hydrology_ini_from_excel.html#generate_mesh_hydrology_ini_from_excel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel.generate_mesh_hydrology_ini_from_excel" title="Link to this definition"></a></dt>
<dd><section id="description">
<h2>Description:<a class="headerlink" href="#description" title="Link to this heading"></a></h2>
<p>This function reads hydrology parameter values from an Excel file and generates
a formatted MESH Hydrology <cite>.ini</cite> file. The generated file is structured into
various parameter categories with appropriate headers, formatting, and spacing.</p>
</section>
<section id="parameters">
<h2>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>excel_file  : str  -&gt; Path to the input Excel file containing parameter values.</p></li>
<li><dl class="simple">
<dt>sheet_name<span class="classifier">str  -&gt; The specific sheet in the Excel file that holds the data.</span></dt><dd><p>Default is “hydrology_ini”.</p>
</dd>
</dl>
</li>
<li><p>output_file : str  -&gt; Path to the output <cite>.ini</cite> file.</p></li>
</ul>
</section>
<section id="function-overview">
<h2>Function Overview:<a class="headerlink" href="#function-overview" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Reads the Excel file and extracts three main parameter categories:
- <strong>Channel Routing Parameters</strong>
- <strong>GRU-Independent Parameters</strong>
- <strong>GRU-Dependent Parameters</strong></p></li>
<li><p>Filters parameters where <cite>status == 1</cite> (active parameters).</p></li>
<li><p>Sorts and formats values for proper alignment:
- Parameter names are <strong>left-aligned</strong> (12 characters).
- Values are <strong>right-aligned</strong> (10 characters, formatted as <cite>.3f</cite> if float).</p></li>
<li><p>Writes the output <cite>.ini</cite> file with section headers, formatted values,
and comments where necessary.</p></li>
</ol>
<section id="example-hydrology-input-file-version-2-0">
<h3>Example Hydrology Input File (Version 2.0):<a class="headerlink" href="#example-hydrology-input-file-version-2-0" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>2.0: MESH Hydrology parameters input file (Version 2.0)
!&gt; Any line leading with &#39;!&#39; is ignored
!&gt; Spacing, whether by tabs or spaces doesn&#39;t matter
!&gt; Parameter/field names are not case sensitive

##### Option Flags #####
----#
    0 # Number of option flags

##### Channel routing parameters #####
-----#
4           # Number of channel routing parameters
R2N              0.100     0.045     0.049     0.013     0.050     0.150     0.141     0.150     0.135     0.314
R1N              0.200     0.167     0.156     0.049     0.064     0.596     0.514     0.422     0.171     0.544
FLZ              0.000     0.000     0.000     0.000     0.000     0.000     0.000     0.000     0.000     0.000
PWR              1.618     2.570     2.721     2.993     2.823     1.361     1.361     1.361     1.361     1.361

##### GRU-independent parameters #####
-------#
5           # Number of GRU independent hydrologic parameters
SOIL_POR_MAX     0.200
SOIL_DEPTH           4
S0                   1
T_ICE_LENS         -10
t0_ACC               0         0         0         0         0

##### GRU-dependent parameters #####
-------#
!&gt; Active headers in sorted order: Forest, BroadLeafForest, MixedForest, wetland, water, Shrub
24          # Number of GRU-dependent parameters
IWF                  1         1         1         1         1         1
ZSNL             0.173     0.393     0.393     0.083     0.110     0.268
ZPLS             0.023     0.097     0.097     0.090     0.090     0.149
ZPLG             0.190     0.282     0.282     0.260     0.090     0.045
FREZTH               0         0         0         0         0         0
SWELIM               0         0         0         0         0         0
SNDENLIM             0         0         0         0         0         0
fetch              300       300       300       300       300       600
Ht                   3         4         4     1.500     0.030     1.200
N_S                  1         1         1         1         1         1
A_S                  1         1         1         1         1         1
Distrib              6         6         6         0         0         1
CMAX             1.500     1.500     1.500     1.500     1.500     1.500
CMIN                 0         0         0         0         0         0
B                    3         3         3         3         3         3
K1                   0         0         0         0         0         0
K2                   0         0         0         0         0         0
irflg                0         0         0         0         0         0
irthlmin         0.500     0.500     0.500     0.500     0.500     0.500
irignd               0         0         0         0         0         0
irt1                 6         6         6         6         6         6
irt2                10        10        10        10        10        10
irijday1             0         0         0         0         0         0
irijday2             0         0         0         0         0         0
</pre></div>
</div>
</section>
</section>
<section id="file-structure">
<h2>File Structure:<a class="headerlink" href="#file-structure" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Header section</strong>: Explains format rules.</p></li>
<li><p><strong>Option Flags</strong>: Indicates no optional flags.</p></li>
<li><p><strong>Channel Routing Parameters</strong>: Defines routing-related parameters.</p></li>
<li><p><strong>GRU-Independent Parameters</strong>: Contains parameters that apply to all land units.</p></li>
<li><p><strong>GRU-Dependent Parameters</strong>: Contains parameters that vary by land category.</p></li>
</ul>
</section>
<section id="gru-dependent-parameters-selection-and-ordering">
<h2>GRU-Dependent Parameters Selection and Ordering:<a class="headerlink" href="#gru-dependent-parameters-selection-and-ordering" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>The <cite>GRU_class_dependent_active</cite> row in the Excel sheet is used to determine
which GRU-dependent headers (columns) are active. Each column corresponding
to a GRU class (e.g., Forest, Grass, Wetland) has a value indicating its
active status:</p></li>
<li><p>A value &gt; 0 indicates the column is active.</p></li>
<li><p>A value &lt;= 0 indicates the column is inactive.</p></li>
<li><p>Active columns are sorted in ascending order based on their values in the
<cite>GRU_class_dependent_active</cite> row. This sorted order determines the sequence
in which GRU-dependent parameters are written to the output file.</p></li>
<li><p>The sorted active column names are included as a comment in the output file
for reference.</p></li>
</ul>
</section>
<section id="example-usage">
<h2>Example Usage:<a class="headerlink" href="#example-usage" title="Link to this heading"></a></h2>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The excel database can be found in the MESHpyPreProcessing folder.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Directly dowolnload the excel file from the MESHpyPreProcessing folder.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/MESH-Scripts-PyLib/MESH-Scripts-PyLib/main/MESHpyPreProcessing/meshparametersvalues2.xlsx&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Local path to save the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">local_path</span> <span class="o">=</span> <span class="s2">&quot;D:/Coding/GitHub/Repos/MESH-Scripts-PyLib/MESHpyPreProcessing/meshparametersvalues2.xlsx&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Send a GET request to download the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check if the request was successful (status code 200)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Write the content to a local file</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File downloaded successfully and saved to </span><span class="si">{</span><span class="n">local_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to download file. Status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_mesh_hydrology_ini_from_excel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_hydini</span> <span class="o">=</span> <span class="n">generate_mesh_hydrology_ini_from_excel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_hydini</span><span class="p">(</span>
<span class="go">        sheet_name=&quot;hydrology_ini&quot;,</span>
<span class="go">        output_file=&quot;MeshHydrology2.ini&quot;,</span>
<span class="go">        excel_file=&quot;D:/Coding/GitHub/Repos/MESH-Scripts-PyLib/MESHpyPreProcessing/meshparametersvalues2.xlsx&quot;</span>
<span class="go">    )</span>
</pre></div>
</div>
<ul class="simple">
<li><p>This will generate a properly formatted <cite>MeshHydrology.ini</cite> file in the specified path.</p></li>
</ul>
</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="generate_mesh_class_ini_from_excel.html" class="btn btn-neutral float-left" title="generate_mesh_class_ini_from_excel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="remap_climate_to_ddb.html" class="btn btn-neutral float-right" title="remap_climate_to_ddb" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Fuad Yassin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>