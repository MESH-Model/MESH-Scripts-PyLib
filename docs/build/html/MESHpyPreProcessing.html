

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MESHpyPreProcessing package &mdash; MESH-Scripts-PyLib 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MESHpyPostProcessing package" href="MESHpyPostProcessing.html" />
    <link rel="prev" title="&lt;no title&gt;" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MESH-Scripts-PyLib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Python Modules</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">MESHpyPreProcessing package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-MESHpyPreProcessing.Aggregation_vector">MESHpyPreProcessing.Aggregation_vector module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basin-and-river-network-aggregation">Basin and River Network Aggregation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-usage">Example usage:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.Aggregation_vector.merit_basin_aggregation"><code class="docutils literal notranslate"><span class="pre">merit_basin_aggregation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#meshpypreprocessing-netcdfwriter-module">MESHpyPreProcessing.NetCDFWriter module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#function-descriptions">Function Descriptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.NetCDFWriter.NetCDFWriter"><code class="docutils literal notranslate"><span class="pre">NetCDFWriter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.NetCDFWriter.read_shapefile"><code class="docutils literal notranslate"><span class="pre">read_shapefile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.NetCDFWriter.set_coordinates"><code class="docutils literal notranslate"><span class="pre">set_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.NetCDFWriter.set_num_soil_layers"><code class="docutils literal notranslate"><span class="pre">set_num_soil_layers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.NetCDFWriter.add_var_attrs"><code class="docutils literal notranslate"><span class="pre">add_var_attrs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.NetCDFWriter.write_netcdf"><code class="docutils literal notranslate"><span class="pre">write_netcdf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Example Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-MESHpyPreProcessing.convert_ddbnetcdf">MESHpyPreProcessing.convert_ddbnetcdf module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#netcdf-to-csv-shapefile-converter">NetCDF to CSV/Shapefile Converter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Example Usage:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#functions">Functions:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Parameters:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.convert_ddbnetcdf.convert_netcdf"><code class="docutils literal notranslate"><span class="pre">convert_netcdf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-MESHpyPreProcessing.gdf_edit">MESHpyPreProcessing.gdf_edit module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gdf-edit-py">gdf_edit.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Example Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.gdf_edit.flag_ncaalg"><code class="docutils literal notranslate"><span class="pre">flag_ncaalg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.gdf_edit.flag_ncaalg_from_files"><code class="docutils literal notranslate"><span class="pre">flag_ncaalg_from_files()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-MESHpyPreProcessing.gen_streamflow_file">MESHpyPreProcessing.gen_streamflow_file module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#streamflow-file-preparation">Streamflow File Preparation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Parameters:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-usage-please-check-mesh-streamflowfile-example-ipynb-for-step-by-step-example">Example Usage (Please check MESH_streamflowFile_example.ipynb for step by step example)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile"><code class="docutils literal notranslate"><span class="pre">GenStreamflowFile</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.create_date_range"><code class="docutils literal notranslate"><span class="pre">GenStreamflowFile.create_date_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.extract_flow_data_us"><code class="docutils literal notranslate"><span class="pre">GenStreamflowFile.extract_flow_data_us()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.fetch_hydrometric_data_ca"><code class="docutils literal notranslate"><span class="pre">GenStreamflowFile.fetch_hydrometric_data_ca()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.write_flow_data_to_file_ensim"><code class="docutils literal notranslate"><span class="pre">GenStreamflowFile.write_flow_data_to_file_ensim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.write_flow_data_to_file_obstxt"><code class="docutils literal notranslate"><span class="pre">GenStreamflowFile.write_flow_data_to_file_obstxt()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-MESHpyPreProcessing.generate_mesh_class_ini_from_excel">MESHpyPreProcessing.generate_mesh_class_ini_from_excel module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.generate_mesh_class_ini_from_excel.generate_mesh_class_ini_from_excel"><code class="docutils literal notranslate"><span class="pre">generate_mesh_class_ini_from_excel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel">MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel.generate_mesh_hydrology_ini_from_excel"><code class="docutils literal notranslate"><span class="pre">generate_mesh_hydrology_ini_from_excel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#meshpypreprocessing-gsde-soil-module">MESHpyPreProcessing.gsde_soil module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id17">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">Function Descriptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gsde_soil.GSDESoil"><code class="docutils literal notranslate"><span class="pre">GSDESoil</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gsde_soil.load_data"><code class="docutils literal notranslate"><span class="pre">load_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gsde_soil.fill_and_clean_data"><code class="docutils literal notranslate"><span class="pre">fill_and_clean_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gsde_soil.calculate_weights"><code class="docutils literal notranslate"><span class="pre">calculate_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gsde_soil.calculate_mesh_values"><code class="docutils literal notranslate"><span class="pre">calculate_mesh_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gsde_soil.merge_and_save_shapefile"><code class="docutils literal notranslate"><span class="pre">merge_and_save_shapefile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MESHpyPreProcessing.gsde_soil.set_coordinates"><code class="docutils literal notranslate"><span class="pre">set_coordinates()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id19">Example Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-MESHpyPreProcessing.remap_climate_to_ddb">MESHpyPreProcessing.remap_climate_to_ddb module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.remap_climate_to_ddb.process_file"><code class="docutils literal notranslate"><span class="pre">process_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.remap_climate_to_ddb.remap_rdrs_climate_data"><code class="docutils literal notranslate"><span class="pre">remap_rdrs_climate_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MESHpyPreProcessing.remap_climate_to_ddb.remap_rdrs_climate_data_single_year"><code class="docutils literal notranslate"><span class="pre">remap_rdrs_climate_data_single_year()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-MESHpyPreProcessing">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MESHpyPostProcessing.html">MESHpyPostProcessing package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="MESH_StreamflowFilePrep.html">MESH Streamflow File Preparation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MESH-Scripts-PyLib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">&lt;no title&gt;</a></li>
      <li class="breadcrumb-item active">MESHpyPreProcessing package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/fuadyassin/MESH-Scripts-PyLib/blob/main/docs/source/MESHpyPreProcessing.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="meshpypreprocessing-package">
<h1>MESHpyPreProcessing package<a class="headerlink" href="#meshpypreprocessing-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-MESHpyPreProcessing.Aggregation_vector">
<span id="meshpypreprocessing-aggregation-vector-module"></span><h2>MESHpyPreProcessing.Aggregation_vector module<a class="headerlink" href="#module-MESHpyPreProcessing.Aggregation_vector" title="Link to this heading"></a></h2>
<section id="basin-and-river-network-aggregation">
<h3>Basin and River Network Aggregation<a class="headerlink" href="#basin-and-river-network-aggregation" title="Link to this heading"></a></h3>
<p>The <cite>merit_basin_aggregation</cite> function aggregates basin and river network shapefiles.
This function uses parameters like minimum sub-area, slope, and river length to iteratively
aggregate small sub-basins.</p>
<section id="parameters">
<h4>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><cite>input_basin</cite>: Basin GeoDataFrame with COMID identifiers.</p></li>
<li><p><cite>input_river</cite>: River network GeoDataFrame with slope and length attributes.</p></li>
<li><p><cite>min_subarea</cite>: Minimum area for sub-basins.</p></li>
<li><p><cite>min_slope</cite>: Minimum allowable river slope.</p></li>
<li><p><cite>min_length</cite>: Minimum river length.</p></li>
</ul>
<p>This function iterates through sub-basins, merging those below the minimum sub-area
threshold until no further aggregation is possible. It also computes and adjusts slopes,
river lengths, and weighted slopes for simplified river networks.</p>
</section>
<section id="example-usage">
<h4>Example usage:<a class="headerlink" href="#example-usage" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">MESHpyPreProcessing.Aggregation_vector</span><span class="w"> </span><span class="kn">import</span> <span class="n">merit_basin_aggregation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define paths and parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_basin_path</span> <span class="o">=</span> <span class="s2">&quot;/home/fuaday/github-repos/Souris_Assiniboine_MAF/1-geofabric/SrsAboine-geofabric/sras_subbasins_MAF_noAgg.shp&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_river_path</span> <span class="o">=</span> <span class="s2">&quot;/home/fuaday/github-repos/Souris_Assiniboine_MAF/1-geofabric/SrsAboine-geofabric/sras_rivers_MAF_noAgg.shp&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_subarea</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_slope</span> <span class="o">=</span> <span class="mf">0.0000001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_length</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_basin_path</span> <span class="o">=</span> <span class="s2">&quot;/home/fuaday/github-repos/Souris_Assiniboine_MAF/1-geofabric/sras_subbasins_MAF_Agg.shp&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_river_path</span> <span class="o">=</span> <span class="s2">&quot;/home/fuaday/github-repos/Souris_Assiniboine_MAF/1-geofabric/sras_rivers_MAF_Agg.shp&quot;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load input data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_basin</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">input_basin_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_river</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">input_river_path</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform aggregation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agg_basin</span><span class="p">,</span> <span class="n">agg_river</span> <span class="o">=</span> <span class="n">merit_basin_aggregation</span><span class="p">(</span><span class="n">input_basin</span><span class="p">,</span> <span class="n">input_river</span><span class="p">,</span> <span class="n">min_subarea</span><span class="p">,</span> <span class="n">min_slope</span><span class="p">,</span> <span class="n">min_length</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save aggregated data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agg_basin</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output_basin_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agg_river</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output_river_path</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.Aggregation_vector.merit_basin_aggregation">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.Aggregation_vector.</span></span><span class="sig-name descname"><span class="pre">merit_basin_aggregation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_basin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_river</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_subarea</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_slope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/Aggregation_vector.html#merit_basin_aggregation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.Aggregation_vector.merit_basin_aggregation" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="meshpypreprocessing-netcdfwriter-module">
<h2>MESHpyPreProcessing.NetCDFWriter module<a class="headerlink" href="#meshpypreprocessing-netcdfwriter-module" title="Link to this heading"></a></h2>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NetCDFWriter</span></code> class is designed to generate model-ready NetCDF files (e.g., MESH_parameters.nc) containing
soil and other geophysical subbasin data integrated from a vector shapefile and a NetCDF drainage database.
This class is typically used in workflows that prepare input parameters for land surface models like MESH.</p>
<p>It supports flexible handling of both <strong>layer-dependent</strong> (e.g., soil properties per depth layer) and
<strong>layer-independent</strong> (e.g., slope, contributing area) variables. The output conforms to CF conventions
and includes appropriate coordinate reference metadata for spatial consistency.</p>
</section>
<section id="function-descriptions">
<h3>Function Descriptions<a class="headerlink" href="#function-descriptions" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="MESHpyPreProcessing.NetCDFWriter.NetCDFWriter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.NetCDFWriter.</span></span><span class="sig-name descname"><span class="pre">NetCDFWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nc_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapefile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_ddb_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/NetCDFWriter.html#NetCDFWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.NetCDFWriter.NetCDFWriter" title="Link to this definition"></a></dt>
<dd><p>Initializes the NetCDF writer with paths to the output file, input shapefile, and NetCDF drainage database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nc_filename</strong> (<em>str</em>) – Path to the NetCDF output file to be created.</p></li>
<li><p><strong>shapefile_path</strong> (<em>str</em>) – Path to the input shapefile containing the attributes.</p></li>
<li><p><strong>input_ddb_path</strong> (<em>str</em>) – Path to the NetCDF drainage database used to extract coordinates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.NetCDFWriter.read_shapefile">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.NetCDFWriter.</span></span><span class="sig-name descname"><span class="pre">read_shapefile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.NetCDFWriter.read_shapefile" title="Link to this definition"></a></dt>
<dd><p>Reads the input shapefile and converts it into a GeoDataFrame. The file is automatically reprojected to EPSG:4326 (WGS 84).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.NetCDFWriter.set_coordinates">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.NetCDFWriter.</span></span><span class="sig-name descname"><span class="pre">set_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.NetCDFWriter.set_coordinates" title="Link to this definition"></a></dt>
<dd><p>Extracts <cite>lon</cite>, <cite>lat</cite>, and <cite>subbasin</cite> values from the NetCDF drainage database file. These values serve as the spatial base for NetCDF output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.NetCDFWriter.set_num_soil_layers">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.NetCDFWriter.</span></span><span class="sig-name descname"><span class="pre">set_num_soil_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_layers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.NetCDFWriter.set_num_soil_layers" title="Link to this definition"></a></dt>
<dd><p>Sets the number of vertical soil layers that will be written into the NetCDF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_layers</strong> (<em>int</em>) – The number of soil layers (e.g., 4 for a 4-layer soil profile).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.NetCDFWriter.add_var_attrs">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.NetCDFWriter.</span></span><span class="sig-name descname"><span class="pre">add_var_attrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.NetCDFWriter.add_var_attrs" title="Link to this definition"></a></dt>
<dd><p>Adds metadata attributes to a NetCDF variable, such as units, standard name, and axis designation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var</strong> (<em>netCDF4.Variable</em>) – The NetCDF variable to modify.</p></li>
<li><p><strong>attrs</strong> (<em>dict</em>) – Dictionary of attributes to apply.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.NetCDFWriter.write_netcdf">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.NetCDFWriter.</span></span><span class="sig-name descname"><span class="pre">write_netcdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.NetCDFWriter.write_netcdf" title="Link to this definition"></a></dt>
<dd><p>Writes the actual NetCDF file using the specified properties and metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>properties</strong> (<em>dict</em>) – Dictionary specifying which variables are layer-dependent vs. layer-independent.</p></li>
<li><p><strong>variable_info</strong> (<em>dict</em>) – Dictionary mapping each variable to a tuple of (NetCDF name, data type, unit).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="id1">
<h3>Example Usage<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">MESHpyPreProcessing.NetCDFWriter</span><span class="w"> </span><span class="kn">import</span> <span class="n">NetCDFWriter</span>

<span class="c1"># Paths for NetCDFWriter</span>
<span class="n">nc_filename</span> <span class="o">=</span> <span class="s1">&#39;MESH_parameters3.nc&#39;</span>
<span class="n">output_shapefile</span> <span class="o">=</span> <span class="s1">&#39;merged_soil_data_shapefile4.shp&#39;</span>
<span class="n">input_ddb</span> <span class="o">=</span> <span class="s1">&#39;/scratch/fuaday/sras-agg-model/MESH-sras-agg/MESH_drainage_database.nc&#39;</span>
<span class="n">mesh_intervals</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">)]</span>

<span class="c1"># Initialize NetCDFWriter with the necessary paths</span>
<span class="n">nc_writer</span> <span class="o">=</span> <span class="n">NetCDFWriter</span><span class="p">(</span>
    <span class="n">nc_filename</span><span class="o">=</span><span class="n">nc_filename</span><span class="p">,</span>
    <span class="n">shapefile_path</span><span class="o">=</span><span class="n">output_shapefile</span><span class="p">,</span>
    <span class="n">input_ddb_path</span><span class="o">=</span><span class="n">input_ddb</span>
<span class="p">)</span>

<span class="c1"># Step 1: Read the attribute shapefile and extract spatial coordinates from the drainage database</span>
<span class="n">nc_writer</span><span class="o">.</span><span class="n">read_shapefile</span><span class="p">()</span>
<span class="n">nc_writer</span><span class="o">.</span><span class="n">set_coordinates</span><span class="p">()</span>

<span class="c1"># Step 2: Specify the number of vertical soil layers to include in the output</span>
<span class="n">nc_writer</span><span class="o">.</span><span class="n">set_num_soil_layers</span><span class="p">(</span><span class="n">num_layers</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">mesh_intervals</span><span class="p">))</span>

<span class="c1"># Step 3: Define which variables are layer-dependent vs. layer-independent</span>
<span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;layer_dependent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CLAY&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND&#39;</span><span class="p">,</span> <span class="s1">&#39;OC&#39;</span><span class="p">],</span>  <span class="c1"># Varies by soil layer and subbasin</span>
    <span class="s1">&#39;layer_independent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ncontr&#39;</span><span class="p">,</span> <span class="s1">&#39;meanBDRICM&#39;</span><span class="p">,</span> <span class="s1">&#39;meanBDTICM&#39;</span><span class="p">,</span> <span class="s1">&#39;xslp&#39;</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">]</span>  <span class="c1"># Varies only by subbasin</span>
<span class="p">}</span>

<span class="c1"># Step 4: Provide metadata for each variable to be written to NetCDF</span>
<span class="n">variable_info</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;CLAY&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;CLAY&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">,</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">),</span>
    <span class="s1">&#39;SAND&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;SAND&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">,</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">),</span>
    <span class="s1">&#39;OC&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;ORGM&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">,</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">),</span>
    <span class="s1">&#39;ncontr&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;IWF&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">),</span>
    <span class="s1">&#39;meanBDRICM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;BDRICM&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">,</span> <span class="s1">&#39;Meters&#39;</span><span class="p">),</span>
    <span class="s1">&#39;meanBDTICM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;BDTICM&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">,</span> <span class="s1">&#39;Meters&#39;</span><span class="p">),</span>
    <span class="s1">&#39;xslp&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;xslp&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">,</span> <span class="s1">&#39;degree&#39;</span><span class="p">),</span>
    <span class="s1">&#39;dd&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">,</span> <span class="s1">&#39;m_per_km2&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Step 5: Write the final NetCDF file with structured metadata and spatial consistency</span>
<span class="n">nc_writer</span><span class="o">.</span><span class="n">write_netcdf</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">,</span> <span class="n">variable_info</span><span class="o">=</span><span class="n">variable_info</span><span class="p">)</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.NetCDFWriter.</span></span><span class="sig-name descname"><span class="pre">NetCDFWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nc_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapefile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_ddb_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/NetCDFWriter.html#NetCDFWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to generate NetCDF files with soil data merged from shapefiles and NetCDF drainage databases.</p>
<section id="attributes">
<h3>Attributes:<a class="headerlink" href="#attributes" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nc_filename<span class="classifier">str</span></dt><dd><p>Path to the output NetCDF file.</p>
</dd>
<dt>shapefile_path<span class="classifier">str</span></dt><dd><p>Path to the input shapefile.</p>
</dd>
<dt>input_ddb_path<span class="classifier">str</span></dt><dd><p>Path to the NetCDF drainage database.</p>
</dd>
<dt>merged_gdf<span class="classifier">geopandas.GeoDataFrame</span></dt><dd><p>GeoDataFrame containing merged shapefile data.</p>
</dd>
<dt>lon<span class="classifier">list</span></dt><dd><p>List of longitude values from the NetCDF drainage database.</p>
</dd>
<dt>lat<span class="classifier">list</span></dt><dd><p>List of latitude values from the NetCDF drainage database.</p>
</dd>
<dt>segid<span class="classifier">list</span></dt><dd><p>List of subbasin identifiers.</p>
</dd>
<dt>num_soil_lyrs<span class="classifier">int</span></dt><dd><p>Number of soil layers in the dataset.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">add_var_attrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/NetCDFWriter.html#NetCDFWriter.add_var_attrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Adds attributes to a NetCDF variable.</p>
<section id="id2">
<h4>Parameters:<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>var<span class="classifier">netCDF4.Variable</span></dt><dd><p>The NetCDF variable to which attributes will be added.</p>
</dd>
<dt>attrs<span class="classifier">dict</span></dt><dd><p>A dictionary of attribute names and values.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">read_shapefile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/NetCDFWriter.html#NetCDFWriter.read_shapefile"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reads the shapefile and converts it into a GeoDataFrame.</p>
<p>This function reads the shapefile, reprojects it to EPSG:4326 (WGS 84),
and stores the result in the merged GeoDataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">set_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/NetCDFWriter.html#NetCDFWriter.set_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Extracts longitude, latitude, and subbasin IDs from the NetCDF drainage database.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">set_num_soil_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_layers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/NetCDFWriter.html#NetCDFWriter.set_num_soil_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Sets the number of soil layers for the NetCDF file.</p>
<section id="id3">
<h4>Parameters:<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>num_layers<span class="classifier">int</span></dt><dd><p>Number of soil layers to be included in the NetCDF file.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_netcdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/NetCDFWriter.html#NetCDFWriter.write_netcdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Creates a NetCDF file with processed soil data.</p>
<section id="id4">
<h4>Parameters:<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>properties<span class="classifier">dict</span></dt><dd><p>A dictionary with two keys:
- ‘layer_dependent’: List of property names tied to the number of soil layers.
- ‘layer_independent’: List of property names dependent only on the subbasin.</p>
</dd>
<dt>variable_info<span class="classifier">dict</span></dt><dd><p>A dictionary mapping property names to tuples containing:
(new variable name in NetCDF, data type code, unit).</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

</section>
<section id="module-MESHpyPreProcessing.convert_ddbnetcdf">
<span id="meshpypreprocessing-convert-ddbnetcdf-module"></span><h2>MESHpyPreProcessing.convert_ddbnetcdf module<a class="headerlink" href="#module-MESHpyPreProcessing.convert_ddbnetcdf" title="Link to this heading"></a></h2>
<section id="netcdf-to-csv-shapefile-converter">
<h3>NetCDF to CSV/Shapefile Converter<a class="headerlink" href="#netcdf-to-csv-shapefile-converter" title="Link to this heading"></a></h3>
<p>This script converts a NetCDF file containing hydrological data into either a CSV file or a Shapefile.</p>
<p>This script contains a function <cite>convert_netcdf</cite> that converts a NetCDF file into either a CSV file or a Shapefile.</p>
<section id="id5">
<h4>Example Usage:<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">convert_ddbnetcdf</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_netcdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert_netcdf</span><span class="p">(</span><span class="n">netcdf_file</span><span class="o">=</span><span class="s1">&#39;input.nc&#39;</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;output.csv&#39;</span><span class="p">,</span> <span class="n">conversion_type</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert_netcdf</span><span class="p">(</span><span class="n">netcdf_file</span><span class="o">=</span><span class="s1">&#39;input.nc&#39;</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;output.shp&#39;</span><span class="p">,</span> <span class="n">conversion_type</span><span class="o">=</span><span class="s1">&#39;shapefile&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="functions">
<h4>Functions:<a class="headerlink" href="#functions" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>convert_netcdf: Converts a NetCDF file into either a CSV or a Shapefile.</p></li>
</ul>
</section>
<section id="id6">
<h4>Parameters:<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>netcdf_file (str): Path to the input NetCDF file.</p></li>
<li><p>output_file (str): Path to the output file (CSV or Shapefile).</p></li>
<li><p>conversion_type (str): Conversion type, either “csv” or “shapefile”.</p></li>
</ul>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.convert_ddbnetcdf.convert_netcdf">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.convert_ddbnetcdf.</span></span><span class="sig-name descname"><span class="pre">convert_netcdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">netcdf_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conversion_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'csv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/convert_ddbnetcdf.html#convert_netcdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.convert_ddbnetcdf.convert_netcdf" title="Link to this definition"></a></dt>
<dd><p>Converts a NetCDF file to either a CSV or a Shapefile.</p>
<section id="id7">
<h3>Parameters:<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>netcdf_file<span class="classifier">str</span></dt><dd><p>Path to the input NetCDF file.</p>
</dd>
<dt>output_file<span class="classifier">str</span></dt><dd><p>Path to the output file (CSV or Shapefile).</p>
</dd>
<dt>conversion_type<span class="classifier">str, optional</span></dt><dd><p>Type of conversion (“csv” or “shapefile”), default is “csv”.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<p>None</p>
</section>
</dd></dl>

</section>
<section id="module-MESHpyPreProcessing.gdf_edit">
<span id="meshpypreprocessing-gdf-edit-module"></span><h2>MESHpyPreProcessing.gdf_edit module<a class="headerlink" href="#module-MESHpyPreProcessing.gdf_edit" title="Link to this heading"></a></h2>
<section id="gdf-edit-py">
<h3>gdf_edit.py<a class="headerlink" href="#gdf-edit-py" title="Link to this heading"></a></h3>
<p>This module provides functions to flag non-contributing areas (NCAs) or lakes and reservoirs in GeoDataFrames
based on intersection thresholds, with customizable options for column names, default values, and initialization values.</p>
<section id="id8">
<h4>Example Usage<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<p>1. Using Shapefiles:
&gt;&gt;&gt; from MESHpyPreProcessing.gdf_edit import flag_ncaalg_from_files
&gt;&gt;&gt; flagged_gdf = flag_ncaalg_from_files(
…     ‘path/to/shapefile1.shp’,
…     ‘path/to/shapefile2.shp’,
…     threshold=0.1,
…     output_path=’output.shp’
… )</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flagged_gdf</span> <span class="o">=</span> <span class="n">flag_ncaalg_from_files</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;path/to/shapefile1.shp&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;path/to/shapefile2.shp&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">output_path</span><span class="o">=</span><span class="s1">&#39;output.shp&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ncontr_col</span><span class="o">=</span><span class="s2">&quot;custom_flag_column&quot;</span><span class="p">,</span>   <span class="c1"># Custom column in gdf1 to store flags</span>
<span class="gp">... </span>    <span class="n">value_column</span><span class="o">=</span><span class="s2">&quot;NON_ID&quot;</span><span class="p">,</span>             <span class="c1"># Column in gdf2 with values to assign</span>
<span class="gp">... </span>    <span class="n">initial_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                   <span class="c1"># Initial value for gdf1&#39;s flag column</span>
<span class="gp">... </span>    <span class="n">default_value</span><span class="o">=</span><span class="mi">5</span>                    <span class="c1"># Default value if no value_column specified</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>2. Using GeoDataFrames Directly:
&gt;&gt;&gt; from MESHpyPreProcessing.gdf_edit import flag_ncaalg
&gt;&gt;&gt; import geopandas as gpd
&gt;&gt;&gt; gdf1 = gpd.read_file(‘path/to/shapefile1.shp’)
&gt;&gt;&gt; gdf2 = gpd.read_file(‘path/to/shapefile2.shp’)
&gt;&gt;&gt; flagged_gdf = flag_ncaalg(gdf1, gdf2, threshold=0.1)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flagged_gdf</span> <span class="o">=</span> <span class="n">flag_ncaalg</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">gdf1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">gdf2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ncontr_col</span><span class="o">=</span><span class="s2">&quot;custom_flag_column&quot;</span><span class="p">,</span>   <span class="c1"># Custom column in gdf1 to store flags</span>
<span class="gp">... </span>    <span class="n">value_column</span><span class="o">=</span><span class="s2">&quot;NON_ID&quot;</span><span class="p">,</span>             <span class="c1"># Column in gdf2 with values to assign</span>
<span class="gp">... </span>    <span class="n">initial_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                   <span class="c1"># Initial value for gdf1&#39;s flag column</span>
<span class="gp">... </span>    <span class="n">default_value</span><span class="o">=</span><span class="mi">5</span>                    <span class="c1"># Default value if no value_column specified</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gdf_edit.flag_ncaalg">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gdf_edit.</span></span><span class="sig-name descname"><span class="pre">flag_ncaalg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gdf1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GeoDataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gdf2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GeoDataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncontr_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ncontr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="reference internal" href="_modules/MESHpyPreProcessing/gdf_edit.html#flag_ncaalg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.gdf_edit.flag_ncaalg" title="Link to this definition"></a></dt>
<dd><p>Flag intersections and optionally assign values from gdf2.</p>
<p>This function identifies intersections between polygons in gdf1 and gdf2 that meet a specified
threshold. If an intersection is found, a constant value (default is 2) or a value from a specified
column in gdf2 (if provided) is assigned to the corresponding row in gdf1. If multiple intersections
exist, the first match is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gdf1</strong> (<em>gpd.GeoDataFrame</em>) – The primary GeoDataFrame.</p></li>
<li><p><strong>gdf2</strong> (<em>gpd.GeoDataFrame</em>) – The secondary GeoDataFrame with values to assign.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold for considering an intersection significant (default is 0.1 or 10%).</p></li>
<li><p><strong>output_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path where the modified gdf1 should be saved. If None, the file is not saved.</p></li>
<li><p><strong>ncontr_col</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column to store assigned values in gdf1.</p></li>
<li><p><strong>value_column</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column in gdf2 with values to assign to gdf1. If None, a constant value (default_value) is used.</p></li>
<li><p><strong>initial_value</strong> (<em>optional</em>) – The initial value to assign to the ncontr_col column in gdf1 before processing intersections.</p></li>
<li><p><strong>default_value</strong> (<em>optional</em>) – The default value to assign to the ncontr_col column if value_column is None (default is 2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modified gdf1 with assigned values based on intersections.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>gpd.GeoDataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gdf_edit.flag_ncaalg_from_files">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gdf_edit.</span></span><span class="sig-name descname"><span class="pre">flag_ncaalg_from_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shapefile1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapefile2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncontr_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ncontr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="reference internal" href="_modules/MESHpyPreProcessing/gdf_edit.html#flag_ncaalg_from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.gdf_edit.flag_ncaalg_from_files" title="Link to this definition"></a></dt>
<dd><p>Read two shapefiles, set their CRS to EPSG:4326, and apply the <cite>flag_ncaalg</cite> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shapefile1</strong> (<em>str</em>) – Path to the first shapefile.</p></li>
<li><p><strong>shapefile2</strong> (<em>str</em>) – Path to the second shapefile.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold for considering an intersection significant, as a fraction of
the first GeoDataFrame’s polygon area (default is 0.1 for 10%).</p></li>
<li><p><strong>output_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path where the modified first GeoDataFrame should be saved. If None, the file is not saved.</p></li>
<li><p><strong>ncontr_col</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column to flag intersections in gdf1.</p></li>
<li><p><strong>value_column</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column in gdf2 with values to assign to gdf1.</p></li>
<li><p><strong>initial_value</strong> (<em>optional</em>) – The initial value to assign to the ncontr_col column in gdf1 before processing intersections.</p></li>
<li><p><strong>default_value</strong> (<em>optional</em>) – The default value to assign to the ncontr_col column if value_column is None (default is 2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modified GeoDataFrame of the first GeoDataFrame with the specified column added.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>gpd.GeoDataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-MESHpyPreProcessing.gen_streamflow_file">
<span id="meshpypreprocessing-gen-streamflow-file-module"></span><h2>MESHpyPreProcessing.gen_streamflow_file module<a class="headerlink" href="#module-MESHpyPreProcessing.gen_streamflow_file" title="Link to this heading"></a></h2>
<section id="streamflow-file-preparation">
<h3>Streamflow File Preparation<a class="headerlink" href="#streamflow-file-preparation" title="Link to this heading"></a></h3>
<p>gen_streamflow_file.py contains a class GenStreamflowFile that handles fetching and combining streamflow data from USGS and Environment Canada and generating output in the OBSTXT and ENSIM formats.</p>
<section id="id9">
<h4>Parameters:<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<p><cite>fetch_hydrometric_data_ca</cite>: Fetches flow data from Canadian stations.
<cite>extract_flow_data_us</cite>: Fetches flow data from US stations.
<cite>write_flow_data_to_file_obstxt</cite>: Writes the data in OBSTXT format.
<cite>write_flow_data_to_file_ensim</cite>: Writes the data in ENSIM format.</p>
</section>
<section id="example-usage-please-check-mesh-streamflowfile-example-ipynb-for-step-by-step-example">
<h4>Example Usage (Please check MESH_streamflowFile_example.ipynb for step by step example)<a class="headerlink" href="#example-usage-please-check-mesh-streamflowfile-example-ipynb-for-step-by-step-example" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">MESHpyPreProcessing.gen_streamflow_file</span><span class="w"> </span><span class="kn">import</span> <span class="n">GenStreamflowFile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Initialize the class</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_flow</span> <span class="o">=</span> <span class="n">GenStreamflowFile</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define station IDs for Canada and the US</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">station_ca</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;05GG001&quot;</span><span class="p">,</span> <span class="s2">&quot;05AC012&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">station_us</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;06132200&quot;</span><span class="p">,</span> <span class="s2">&quot;05020500&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set the date range</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start_date</span> <span class="o">=</span> <span class="s2">&quot;1980-03-01&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">end_date</span> <span class="o">=</span> <span class="s2">&quot;2018-01-10&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fetch hydrometric data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combined_data_ca</span><span class="p">,</span> <span class="n">station_info_ca</span> <span class="o">=</span> <span class="n">gen_flow</span><span class="o">.</span><span class="n">fetch_hydrometric_data_ca</span><span class="p">(</span><span class="n">station_ca</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combined_data_us</span><span class="p">,</span> <span class="n">station_info_us</span> <span class="o">=</span> <span class="n">gen_flow</span><span class="o">.</span><span class="n">extract_flow_data_us</span><span class="p">(</span><span class="n">station_us</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Combine the data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combined_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">combined_data_ca</span><span class="p">,</span> <span class="n">combined_data_us</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write to files in OBSTXT and ENSIM formats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_flow</span><span class="o">.</span><span class="n">write_flow_data_to_file_obstxt</span><span class="p">(</span><span class="s1">&#39;MESH_input_streamflow.txt&#39;</span><span class="p">,</span> <span class="n">combined_data</span><span class="p">,</span> <span class="n">station_info_ca</span> <span class="o">+</span> <span class="n">station_info_us</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_flow</span><span class="o">.</span><span class="n">write_flow_data_to_file_ensim</span><span class="p">(</span><span class="s1">&#39;MESH_input_streamflow.tb0&#39;</span><span class="p">,</span> <span class="n">combined_data</span><span class="p">,</span> <span class="n">station_info_ca</span> <span class="o">+</span> <span class="n">station_info_us</span><span class="p">,</span> <span class="n">column_width</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">initial_spacing</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gen_streamflow_file.</span></span><span class="sig-name descname"><span class="pre">GenStreamflowFile</span></span><a class="reference internal" href="_modules/MESHpyPreProcessing/gen_streamflow_file.html#GenStreamflowFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.create_date_range">
<span class="sig-name descname"><span class="pre">create_date_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gen_streamflow_file.html#GenStreamflowFile.create_date_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.create_date_range" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.extract_flow_data_us">
<span class="sig-name descname"><span class="pre">extract_flow_data_us</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gen_streamflow_file.html#GenStreamflowFile.extract_flow_data_us"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.extract_flow_data_us" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.fetch_hydrometric_data_ca">
<span class="sig-name descname"><span class="pre">fetch_hydrometric_data_ca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station_numbers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gen_streamflow_file.html#GenStreamflowFile.fetch_hydrometric_data_ca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.fetch_hydrometric_data_ca" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.write_flow_data_to_file_ensim">
<span class="sig-name descname"><span class="pre">write_flow_data_to_file_ensim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_details</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gen_streamflow_file.html#GenStreamflowFile.write_flow_data_to_file_ensim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.write_flow_data_to_file_ensim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.write_flow_data_to_file_obstxt">
<span class="sig-name descname"><span class="pre">write_flow_data_to_file_obstxt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_details</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gen_streamflow_file.html#GenStreamflowFile.write_flow_data_to_file_obstxt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.gen_streamflow_file.GenStreamflowFile.write_flow_data_to_file_obstxt" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-MESHpyPreProcessing.generate_mesh_class_ini_from_excel">
<span id="meshpypreprocessing-generate-mesh-class-ini-from-excel-module"></span><h2>MESHpyPreProcessing.generate_mesh_class_ini_from_excel module<a class="headerlink" href="#module-MESHpyPreProcessing.generate_mesh_class_ini_from_excel" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.generate_mesh_class_ini_from_excel.generate_mesh_class_ini_from_excel">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.generate_mesh_class_ini_from_excel.</span></span><span class="sig-name descname"><span class="pre">generate_mesh_class_ini_from_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MESH_class_output.ini'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'class_ini'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/generate_mesh_class_ini_from_excel.html#generate_mesh_class_ini_from_excel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.generate_mesh_class_ini_from_excel.generate_mesh_class_ini_from_excel" title="Link to this definition"></a></dt>
<dd><section id="description">
<h3>Description:<a class="headerlink" href="#description" title="Link to this heading"></a></h3>
<p>This function processes an Excel file containing land cover parameter values and
generates a MESH-compatible <cite>.ini</cite> file. The function is designed to extract,
format, and write the required parameters for active land covers into the
output file, ensuring compatibility with the MESH hydrological model.
The function includes detailed steps for processing the Excel file,
extracting relevant data, and formatting it into the required structure for MESH.
It also validates the input data and ensures that all necessary parameters are present.
The existing description below provides further details about the function’s
parameters, processing steps, and output format.</p>
</section>
<section id="id10">
<h3>Parameters:<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>excel_file<span class="classifier">str</span></dt><dd><p>Path to the Excel file containing parameter values.</p>
</dd>
<dt>output_file<span class="classifier">str</span></dt><dd><p>Path to the output <cite>.ini</cite> file where processed values will be written.</p>
</dd>
<dt>num_cels<span class="classifier">int</span></dt><dd><p>Number of grid cells in the model domain.</p>
</dd>
<dt>lat<span class="classifier">float</span></dt><dd><p>Latitude of the location.</p>
</dd>
<dt>lon<span class="classifier">float</span></dt><dd><p>Longitude of the location.</p>
</dd>
</dl>
<section id="id11">
<h4>Overview:<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<p>This function extracts land cover parameter values from an Excel file and
writes them into a MESH-compatible <cite>.ini</cite> file. Only active land covers are
included, as indicated by the ‘status’ row in the Excel sheet.</p>
</section>
<section id="processing-steps">
<h4>Processing Steps:<a class="headerlink" href="#processing-steps" title="Link to this heading"></a></h4>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Load the Excel file and normalize column names.</dt><dd><ul class="simple">
<li><p>The function reads the Excel file using <cite>pandas</cite> and converts all column names to lowercase for consistency.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Identify active land covers (status &gt; 0):
- The function identifies the row labeled ‘status’ in the Excel file, which contains numerical values for each land cover column.
- These numerical values indicate the activation status of each land cover. A value greater than 0 signifies that the land cover is active.
- The function filters out inactive land covers (status &lt;= 0) and retains only the active ones.
- The active land covers are then sorted in ascending order based on their status values to ensure a consistent and logical ordering in the output file.</p></li>
<li><p>Verify required rows such as ‘colum’.</p></li>
<li><p>Extract vegetation and land cover parameters.</p></li>
<li><p>Write formatted values into an <cite>.ini</cite> file with the required MESH structure.</p></li>
</ol>
</section>
<section id="output-format">
<h4>Output Format:<a class="headerlink" href="#output-format" title="Link to this heading"></a></h4>
<p>The output file is structured to be compatible with MESH, including:
- Header defining basin information.
- Land cover-specific vegetation and hydrological parameters.
- Footer containing model time initialization values.</p>
</section>
<section id="file-structure">
<h4>File Structure:<a class="headerlink" href="#file-structure" title="Link to this heading"></a></h4>
<p>The output file consists of:</p>
<ol class="arabic simple">
<li><p><strong>Header Information</strong>: Includes metadata such as location, author, and details.</p></li>
<li><p><strong>Land Cover Blocks</strong>: Each selected land cover is written separately, including:
- Vegetation parameters (written in pairs)
- One-to-One parameter assignments (written in pairs)
- Multi-value parameter assignments (written in structured format)</p></li>
<li><p><strong>Final Footer</strong>: Contains three mandatory lines required for MESH processing.</p></li>
</ol>
</section>
<section id="id12">
<h4>Example Usage:<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The excel database can be found in the MESHpyPreProcessing folder.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Directly dowolnload the excel file from the MESHpyPreProcessing folder.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/MESH-Scripts-PyLib/MESH-Scripts-PyLib/main/MESHpyPreProcessing/meshparametersvalues2.xlsx&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Local path to save the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">local_path</span> <span class="o">=</span> <span class="s2">&quot;D:/Coding/GitHub/Repos/MESH-Scripts-PyLib/MESHpyPreProcessing/meshparametersvalues2.xlsx&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Send a GET request to download the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check if the request was successful (status code 200)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Write the content to a local file</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File downloaded successfully and saved to </span><span class="si">{</span><span class="n">local_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to download file. Status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example usage of the function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">MESHpyPreProcessing.generate_mesh_class_ini_from_excel</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_mesh_class_ini_from_excel</span> <span class="k">as</span> <span class="n">gen_classini</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_classini</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">excel_file</span><span class="o">=</span><span class="s2">&quot;D:/Coding/GitHub/Repos/MESH-Scripts-PyLib/MESHpyPreProcessing/meshparametersvalues2.xlsx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">output_file</span><span class="o">=</span><span class="s2">&quot;MESH_output2.ini&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_cels</span><span class="o">=</span><span class="mi">7408</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">lat</span><span class="o">=</span><span class="mf">53.18</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">lon</span><span class="o">=-</span><span class="mf">99.25</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-output">
<h4>Example Output:<a class="headerlink" href="#example-output" title="Link to this heading"></a></h4>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Basin
Author
Org
53.18     -99.25     40.00     40.00     50.00   -1.0    1 7408    5
0.000      0.000      0.000      0.000      1.000      0.000      0.000      0.000      0.000             # fcan, lamx
0.000      0.000      0.000      0.000     -5.352      0.000      0.000      0.000      0.000             # lnz, lamn
0.000      0.000      0.000      0.000      0.400      0.000      0.000      0.000      0.000             # alvc, cmas
0.000      0.000      0.000      0.000      0.250      0.000      0.000      0.000      0.000             # alir, root
0.000      0.000      0.000      0.000                 0.000      0.000      0.000      0.000             # rsmn, qa50
0.000      0.000      0.000      0.000                 0.000      0.000      0.000      0.000             # vpda, vpdp
0.000      0.000      0.000      0.000                 0.000      0.000      0.000      0.000             # psga, psgb
1.000      2.000      1.000     50.000  # drn, sdep, fare, dden
0.100      0.100      0.388      0.070      8.000     Barren  # xslp, grkf, man, wfci, mid, name
73.000     45.000     66.000  # sand
6.400     29.600     20.440  # clay
7.400      0.000      0.000  # org
4.000      2.000      1.000        4.000        0.000        4.000  # soit, cant, snot, pndt
0.250      0.250      0.250        0.000      0.000      0.000        0.000  # soiwf, soiif, pond
0.000        0.000        0.000        0.500      100.000        1.000  # rcan, scan, sno, albs, rho, gro

0.000      1.000      0.000      0.000      0.000      0.000      4.148      0.000      0.000             # fcan, lamx
0.000      0.475      0.000      0.000      0.000      0.000      0.512      0.000      0.000             # lnz, lamn
0.000      0.049      0.000      0.000      0.000      0.000     23.583      0.000      0.000             # alvc, cmas
0.000      0.257      0.000      0.000      0.000      0.000      1.249      0.000      0.000             # alir, root
0.000    110.930      0.000      0.000                 0.000     37.506      0.000      0.000             # rsmn, qa50
0.000      0.427      0.000      0.000                 0.000      0.765      0.000      0.000             # vpda, vpdp
0.000    100.000      0.000      0.000                 0.000      5.000      0.000      0.000             # psga, psgb
1.000      2.000      1.000     50.000  # drn, sdep, fare, dden
0.040      0.100      0.119      0.100      2.000   MixedForest  # xslp, grkf, man, wfci, mid, name
75.000     66.000     66.000  # sand
5.000     30.000     17.000  # clay
5.000      0.000      0.000  # org
4.000      2.000      1.000        4.000        0.000        4.000  # soit, cant, snot, pndt
0.250      0.250      0.250        0.000      0.000      0.000        0.000  # soiwf, soiif, pond
0.000        0.000        0.000        0.500      100.000        1.000  # rcan, scan, sno, albs, rho, gro

1.000      0.000      0.000      0.000      0.000      1.162      0.000      0.000      0.000             # fcan, lamx
-0.187      0.000      0.000      0.000      0.000      0.509      0.000      0.000      0.000             # lnz, lamn
0.046      0.000      0.000      0.000      0.000     13.624      0.000      0.000      0.000             # alvc, cmas
0.154      0.000      0.000      0.000      0.000      1.768      0.000      0.000      0.000             # alir, root
236.390      0.000      0.000      0.000                27.913      0.000      0.000      0.000             # rsmn, qa50
0.502      0.000      0.000      0.000                 0.812      0.000      0.000      0.000             # vpda, vpdp
100.000      0.000      0.000      0.000                 5.000      0.000      0.000      0.000             # psga, psgb
1.000      2.000      1.000     50.000  # drn, sdep, fare, dden
0.040      0.122      0.151      1.380      1.000     Forest  # xslp, grkf, man, wfci, mid, name
73.200     43.300     72.903  # sand
5.200     29.100     21.362  # clay
5.000      0.000      0.000  # org
4.000      2.000      1.000        4.000        0.000        4.000  # soit, cant, snot, pndt
0.250      0.250      0.250        0.000      0.000      0.000        0.000  # soiwf, soiif, pond
0.000        0.000        0.000        0.500      100.000        1.000  # rcan, scan, sno, albs, rho, gro

0.000      0.000      1.000      0.000      0.000      0.000      0.000      5.807      0.000             # fcan, lamx
0.000      0.000     -2.541      0.000      0.000      0.000      0.000      0.000      0.000             # lnz, lamn
0.000      0.000      0.061      0.000      0.000      0.000      0.000      1.923      0.000             # alvc, cmas
0.000      0.000      0.298      0.000      0.000      0.000      0.000      1.200      0.000             # alir, root
0.000      0.000     63.107      0.000                 0.000      0.000     22.541      0.000             # rsmn, qa50
0.000      0.000      0.568      0.000                 0.000      0.000      0.804      0.000             # vpda, vpdp
0.000      0.000    100.000      0.000                 0.000      0.000      5.000      0.000             # psga, psgb
1.000      2.000      1.000     40.000  # drn, sdep, fare, dden
0.010      0.503      0.164      1.432      4.000       Crop  # xslp, grkf, man, wfci, mid, name
50.000     55.000     60.000  # sand
35.000     35.000     35.000  # clay
15.000     10.000      5.000  # org
4.000      2.000      1.000        4.000        0.000        4.000  # soit, cant, snot, pndt
0.250      0.250      0.250        0.000      0.000      0.000        0.000  # soiwf, soiif, pond
0.000        0.000        0.000        0.500      100.000        1.000  # rcan, scan, sno, albs, rho, gro

0.000      0.000      0.000      1.000      0.000      0.000      0.000      0.000      2.000             # fcan, lamx
0.000      0.000      0.000     -2.806      0.000      0.000      0.000      0.000      0.500             # lnz, lamn
0.000      0.000      0.000      0.050      0.000      0.000      0.000      0.000      1.200             # alvc, cmas
0.000      0.000      0.000      0.340      0.000      0.000      0.000      0.000      1.200             # alir, root
0.000      0.000      0.000    100.000                 0.000      0.000      0.000     30.000             # rsmn, qa50
0.000      0.000      0.000      0.500                 0.000      0.000      0.000      1.000             # vpda, vpdp
0.000      0.000      0.000    100.000                 0.000      0.000      0.000      5.000             # psga, psgb
1.000      2.000      1.000     50.000  # drn, sdep, fare, dden
0.010      0.200      0.233      0.100      5.000      Grass  # xslp, grkf, man, wfci, mid, name
72.100     49.700     70.020  # sand
5.000     21.400     23.682  # clay
7.800      0.000      0.000  # org
4.000      2.000      1.000        4.000        0.000        4.000  # soit, cant, snot, pndt
0.250      0.250      0.250        0.000      0.000      0.000        0.000  # soiwf, soiif, pond
0.000        0.000        0.000        0.500      100.000        1.000  # rcan, scan, sno, albs, rho, gro

    0         0         0         0                                  20
    0         0         0         0                                  21
    0         0         0         0                                  22 IHOUR/IMINS/IJDAY/IYEAR
</pre></div>
</div>
</section>
</section>
</dd></dl>

</section>
<section id="module-MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel">
<span id="meshpypreprocessing-generate-mesh-hydrology-ini-from-excel-module"></span><h2>MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel module<a class="headerlink" href="#module-MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel.generate_mesh_hydrology_ini_from_excel">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel.</span></span><span class="sig-name descname"><span class="pre">generate_mesh_hydrology_ini_from_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excel_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MeshHydrology.ini'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hydrology_ini'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/generate_mesh_hydrology_ini_from_excel.html#generate_mesh_hydrology_ini_from_excel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel.generate_mesh_hydrology_ini_from_excel" title="Link to this definition"></a></dt>
<dd><section id="id13">
<h3>Description:<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<p>This function reads hydrology parameter values from an Excel file and generates
a formatted MESH Hydrology <cite>.ini</cite> file. The generated file is structured into
various parameter categories with appropriate headers, formatting, and spacing.</p>
</section>
<section id="id14">
<h3>Parameters:<a class="headerlink" href="#id14" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>excel_file  : str  -&gt; Path to the input Excel file containing parameter values.</p></li>
<li><dl class="simple">
<dt>sheet_name<span class="classifier">str  -&gt; The specific sheet in the Excel file that holds the data.</span></dt><dd><p>Default is “hydrology_ini”.</p>
</dd>
</dl>
</li>
<li><p>output_file : str  -&gt; Path to the output <cite>.ini</cite> file.</p></li>
</ul>
</section>
<section id="function-overview">
<h3>Function Overview:<a class="headerlink" href="#function-overview" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Reads the Excel file and extracts three main parameter categories:
- <strong>Channel Routing Parameters</strong>
- <strong>GRU-Independent Parameters</strong>
- <strong>GRU-Dependent Parameters</strong></p></li>
<li><p>Filters parameters where <cite>status == 1</cite> (active parameters).</p></li>
<li><p>Sorts and formats values for proper alignment:
- Parameter names are <strong>left-aligned</strong> (12 characters).
- Values are <strong>right-aligned</strong> (10 characters, formatted as <cite>.3f</cite> if float).</p></li>
<li><p>Writes the output <cite>.ini</cite> file with section headers, formatted values,
and comments where necessary.</p></li>
</ol>
<section id="example-hydrology-input-file-version-2-0">
<h4>Example Hydrology Input File (Version 2.0):<a class="headerlink" href="#example-hydrology-input-file-version-2-0" title="Link to this heading"></a></h4>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>2.0: MESH Hydrology parameters input file (Version 2.0)
!&gt; Any line leading with &#39;!&#39; is ignored
!&gt; Spacing, whether by tabs or spaces doesn&#39;t matter
!&gt; Parameter/field names are not case sensitive

##### Option Flags #####
----#
    0 # Number of option flags

##### Channel routing parameters #####
-----#
4           # Number of channel routing parameters
R2N              0.100     0.045     0.049     0.013     0.050     0.150     0.141     0.150     0.135     0.314
R1N              0.200     0.167     0.156     0.049     0.064     0.596     0.514     0.422     0.171     0.544
FLZ              0.000     0.000     0.000     0.000     0.000     0.000     0.000     0.000     0.000     0.000
PWR              1.618     2.570     2.721     2.993     2.823     1.361     1.361     1.361     1.361     1.361

##### GRU-independent parameters #####
-------#
5           # Number of GRU independent hydrologic parameters
SOIL_POR_MAX     0.200
SOIL_DEPTH           4
S0                   1
T_ICE_LENS         -10
t0_ACC               0         0         0         0         0

##### GRU-dependent parameters #####
-------#
!&gt; Active headers in sorted order: Forest, BroadLeafForest, MixedForest, wetland, water, Shrub
24          # Number of GRU-dependent parameters
IWF                  1         1         1         1         1         1
ZSNL             0.173     0.393     0.393     0.083     0.110     0.268
ZPLS             0.023     0.097     0.097     0.090     0.090     0.149
ZPLG             0.190     0.282     0.282     0.260     0.090     0.045
FREZTH               0         0         0         0         0         0
SWELIM               0         0         0         0         0         0
SNDENLIM             0         0         0         0         0         0
fetch              300       300       300       300       300       600
Ht                   3         4         4     1.500     0.030     1.200
N_S                  1         1         1         1         1         1
A_S                  1         1         1         1         1         1
Distrib              6         6         6         0         0         1
CMAX             1.500     1.500     1.500     1.500     1.500     1.500
CMIN                 0         0         0         0         0         0
B                    3         3         3         3         3         3
K1                   0         0         0         0         0         0
K2                   0         0         0         0         0         0
irflg                0         0         0         0         0         0
irthlmin         0.500     0.500     0.500     0.500     0.500     0.500
irignd               0         0         0         0         0         0
irt1                 6         6         6         6         6         6
irt2                10        10        10        10        10        10
irijday1             0         0         0         0         0         0
irijday2             0         0         0         0         0         0
</pre></div>
</div>
</section>
</section>
<section id="id15">
<h3>File Structure:<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Header section</strong>: Explains format rules.</p></li>
<li><p><strong>Option Flags</strong>: Indicates no optional flags.</p></li>
<li><p><strong>Channel Routing Parameters</strong>: Defines routing-related parameters.</p></li>
<li><p><strong>GRU-Independent Parameters</strong>: Contains parameters that apply to all land units.</p></li>
<li><p><strong>GRU-Dependent Parameters</strong>: Contains parameters that vary by land category.</p></li>
</ul>
</section>
<section id="gru-dependent-parameters-selection-and-ordering">
<h3>GRU-Dependent Parameters Selection and Ordering:<a class="headerlink" href="#gru-dependent-parameters-selection-and-ordering" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The <cite>GRU_class_dependent_active</cite> row in the Excel sheet is used to determine
which GRU-dependent headers (columns) are active. Each column corresponding
to a GRU class (e.g., Forest, Grass, Wetland) has a value indicating its
active status:</p></li>
<li><p>A value &gt; 0 indicates the column is active.</p></li>
<li><p>A value &lt;= 0 indicates the column is inactive.</p></li>
<li><p>Active columns are sorted in ascending order based on their values in the
<cite>GRU_class_dependent_active</cite> row. This sorted order determines the sequence
in which GRU-dependent parameters are written to the output file.</p></li>
<li><p>The sorted active column names are included as a comment in the output file
for reference.</p></li>
</ul>
</section>
<section id="id16">
<h3>Example Usage:<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The excel database can be found in the MESHpyPreProcessing folder.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Directly dowolnload the excel file from the MESHpyPreProcessing folder.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/MESH-Scripts-PyLib/MESH-Scripts-PyLib/main/MESHpyPreProcessing/meshparametersvalues2.xlsx&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Local path to save the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">local_path</span> <span class="o">=</span> <span class="s2">&quot;D:/Coding/GitHub/Repos/MESH-Scripts-PyLib/MESHpyPreProcessing/meshparametersvalues2.xlsx&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Send a GET request to download the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check if the request was successful (status code 200)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Write the content to a local file</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File downloaded successfully and saved to </span><span class="si">{</span><span class="n">local_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to download file. Status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">MESHpyPreProcessing.generate_mesh_hydrology_ini_from_excel</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_mesh_hydrology_ini_from_excel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_hydini</span> <span class="o">=</span> <span class="n">generate_mesh_hydrology_ini_from_excel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_hydini</span><span class="p">(</span>
<span class="go">        sheet_name=&quot;hydrology_ini&quot;,</span>
<span class="go">        output_file=&quot;MeshHydrology2.ini&quot;,</span>
<span class="go">        excel_file=&quot;D:/Coding/GitHub/Repos/MESH-Scripts-PyLib/MESHpyPreProcessing/meshparametersvalues2.xlsx&quot;</span>
<span class="go">    )</span>
</pre></div>
</div>
<ul class="simple">
<li><p>This will generate a properly formatted <cite>MeshHydrology.ini</cite> file in the specified path.</p></li>
</ul>
</section>
</dd></dl>

</section>
<section id="meshpypreprocessing-gsde-soil-module">
<h2>MESHpyPreProcessing.gsde_soil module<a class="headerlink" href="#meshpypreprocessing-gsde-soil-module" title="Link to this heading"></a></h2>
<section id="id17">
<h3>Overview<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">GSDESoil</span></code> class provides a pipeline to process, clean, interpolate, and integrate soil property data
into hydrological model inputs, such as those required by MESH. It is designed to handle GSDE-derived statistics
stored in CSV files, convert them to model-ready format using weighted depth-averaging, and merge them into a
basin shapefile based on unique identifiers (e.g., <code class="docutils literal notranslate"><span class="pre">COMID</span></code>).</p>
</section>
<section id="id18">
<h3>Function Descriptions<a class="headerlink" href="#id18" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gsde_soil.GSDESoil">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gsde_soil.</span></span><span class="sig-name descname"><span class="pre">GSDESoil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_basin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shapefile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gsde_soil.html#GSDESoil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.gsde_soil.GSDESoil" title="Link to this definition"></a></dt>
<dd><p>Initializes the processor with input/output paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (<em>str</em>) – Directory containing input CSV files.</p></li>
<li><p><strong>input_basin</strong> (<em>str</em>) – Path to the input shapefile with a COMID field.</p></li>
<li><p><strong>output_shapefile</strong> (<em>str</em>) – Path where the merged shapefile will be saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gsde_soil.load_data">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gsde_soil.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_replace_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.gsde_soil.load_data" title="Link to this definition"></a></dt>
<dd><p>Loads and merges soil data from multiple CSV files. Columns can be renamed using
search/replace rules and optionally suffixed to avoid name collisions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_names</strong> (<em>list</em>) – List of CSV file names.</p></li>
<li><p><strong>search_replace_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary with filename as key and (search_list, replace_list) as value.</p></li>
<li><p><strong>suffix_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary with filename as key and string suffix as value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gsde_soil.fill_and_clean_data">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gsde_soil.</span></span><span class="sig-name descname"><span class="pre">fill_and_clean_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exclude_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['COMID']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_patterns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['OC',</span> <span class="pre">'BD',</span> <span class="pre">'BDRICM',</span> <span class="pre">'BDTICM']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.gsde_soil.fill_and_clean_data" title="Link to this definition"></a></dt>
<dd><p>Cleans soil data by removing outliers, rescaling BDRICM/BDTICM, and filling missing values via forward/backward fill.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exclude_cols</strong> (<em>list</em>) – Columns to ignore during cleaning.</p></li>
<li><p><strong>exclude_patterns</strong> (<em>list</em>) – Substrings used to skip certain columns during range checks.</p></li>
<li><p><strong>max_val</strong> (<em>float</em>) – Maximum threshold for valid data (values above this become NaN).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gsde_soil.calculate_weights">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gsde_soil.</span></span><span class="sig-name descname"><span class="pre">calculate_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gsde_intervals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_intervals</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.gsde_soil.calculate_weights" title="Link to this definition"></a></dt>
<dd><p>Computes weights to map GSDE soil depth intervals to model mesh layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gsde_intervals</strong> (<em>list</em><em> of </em><em>tuple</em>) – List of tuples representing GSDE depth layers (e.g., [(0, 0.045), …]).</p></li>
<li><p><strong>mesh_intervals</strong> (<em>list</em><em> of </em><em>tuple</em>) – List of tuples representing target model layer depths.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gsde_soil.calculate_mesh_values">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gsde_soil.</span></span><span class="sig-name descname"><span class="pre">calculate_mesh_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.gsde_soil.calculate_mesh_values" title="Link to this definition"></a></dt>
<dd><p>Applies weights to calculate layer-averaged MESH-compatible soil properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>column_names</strong> (<em>dict</em>) – Dictionary mapping each property (e.g., “CLAY”, “OC”) to its source columns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gsde_soil.merge_and_save_shapefile">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gsde_soil.</span></span><span class="sig-name descname"><span class="pre">merge_and_save_shapefile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.gsde_soil.merge_and_save_shapefile" title="Link to this definition"></a></dt>
<dd><p>Merges the processed soil data with the input basin shapefile using <code class="docutils literal notranslate"><span class="pre">COMID</span></code> and saves the final output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MESHpyPreProcessing.gsde_soil.set_coordinates">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gsde_soil.</span></span><span class="sig-name descname"><span class="pre">set_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ddb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MESHpyPreProcessing.gsde_soil.set_coordinates" title="Link to this definition"></a></dt>
<dd><p>Optionally reads spatial reference (lon, lat, subbasin) from a NetCDF drainage database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_ddb</strong> (<em>str</em>) – Path to the NetCDF drainage database file.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id19">
<h3>Example Usage<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">gsde_soil</span><span class="w"> </span><span class="kn">import</span> <span class="n">GSDESoil</span>

<span class="c1"># Step 1: Initialize the soil processor with paths to your directories and files</span>
<span class="n">gsde</span> <span class="o">=</span> <span class="n">GSDESoil</span><span class="p">(</span>
    <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;/home/fuaday/scratch/sras-agg-model/gistool-outputs&#39;</span><span class="p">,</span>
    <span class="n">input_basin</span><span class="o">=</span><span class="s1">&#39;/home/fuaday/scratch/sras-agg-model/geofabric-outputs/sras_subbasins_MAF_Agg2.shp&#39;</span><span class="p">,</span>
    <span class="n">output_shapefile</span><span class="o">=</span><span class="s1">&#39;merged_soil_data_shapefile4.shp&#39;</span>
<span class="p">)</span>

<span class="c1"># Step 2: Define the list of input CSV files</span>
<span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;sras_model_stats_CLAY1.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;sras_model_stats_CLAY2.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sras_model_stats_SAND1.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;sras_model_stats_SAND2.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sras_model_stats_OC1.csv&#39;</span><span class="p">,</span>   <span class="s1">&#39;sras_model_stats_OC2.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sras_model_stats_BDRICM_M_250m_ll.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sras_model_stats_BDTICM_M_250m_ll.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sras_model_slope_degree.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;sras_model_riv_0p1_2.csv&#39;</span>
<span class="p">]</span>

<span class="c1"># Step 3: Prepare renaming instructions for each file (search/replace patterns)</span>
<span class="n">search_replace_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;sras_model_stats_CLAY1.csv&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;.CLAY_depth=4.5&#39;</span><span class="p">,</span> <span class="s1">&#39;.CLAY_depth=9.1000004&#39;</span><span class="p">,</span> <span class="s1">&#39;.CLAY_depth=16.6&#39;</span><span class="p">,</span> <span class="s1">&#39;.CLAY_depth=28.9&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;CLAY1&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY2&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY3&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY4&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;sras_model_stats_CLAY2.csv&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;.CLAY_depth=49.299999&#39;</span><span class="p">,</span> <span class="s1">&#39;.CLAY_depth=82.900002&#39;</span><span class="p">,</span> <span class="s1">&#39;.CLAY_depth=138.3&#39;</span><span class="p">,</span> <span class="s1">&#39;.CLAY_depth=229.60001&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;CLAY5&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY6&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY7&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY8&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;sras_model_stats_SAND1.csv&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;.SAND_depth=4.5&#39;</span><span class="p">,</span> <span class="s1">&#39;.SAND_depth=9.1000004&#39;</span><span class="p">,</span> <span class="s1">&#39;.SAND_depth=16.6&#39;</span><span class="p">,</span> <span class="s1">&#39;.SAND_depth=28.9&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;SAND1&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND2&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND3&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND4&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;sras_model_stats_SAND2.csv&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;.SAND_depth=49.299999&#39;</span><span class="p">,</span> <span class="s1">&#39;.SAND_depth=82.900002&#39;</span><span class="p">,</span> <span class="s1">&#39;.SAND_depth=138.3&#39;</span><span class="p">,</span> <span class="s1">&#39;.SAND_depth=229.60001&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;SAND5&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND6&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND7&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND8&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;sras_model_stats_OC1.csv&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;.OC_depth=4.5&#39;</span><span class="p">,</span> <span class="s1">&#39;.OC_depth=9.1000004&#39;</span><span class="p">,</span> <span class="s1">&#39;.OC_depth=16.6&#39;</span><span class="p">,</span> <span class="s1">&#39;.OC_depth=28.9&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;OC1&#39;</span><span class="p">,</span> <span class="s1">&#39;OC2&#39;</span><span class="p">,</span> <span class="s1">&#39;OC3&#39;</span><span class="p">,</span> <span class="s1">&#39;OC4&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;sras_model_stats_OC2.csv&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;.OC_depth=49.299999&#39;</span><span class="p">,</span> <span class="s1">&#39;.OC_depth=82.900002&#39;</span><span class="p">,</span> <span class="s1">&#39;.OC_depth=138.3&#39;</span><span class="p">,</span> <span class="s1">&#39;.OC_depth=229.60001&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;OC5&#39;</span><span class="p">,</span> <span class="s1">&#39;OC6&#39;</span><span class="p">,</span> <span class="s1">&#39;OC7&#39;</span><span class="p">,</span> <span class="s1">&#39;OC8&#39;</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># Step 4: Optionally specify suffixes to distinguish overlapping columns</span>
<span class="n">suffix_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;sras_model_stats_BDRICM_M_250m_ll.csv&#39;</span><span class="p">:</span> <span class="s1">&#39;BDRICM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sras_model_stats_BDTICM_M_250m_ll.csv&#39;</span><span class="p">:</span> <span class="s1">&#39;BDTICM&#39;</span>
<span class="p">}</span>

<span class="c1"># Step 5: Load the data, applying renaming and suffixes</span>
<span class="n">gsde</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span>
    <span class="n">file_names</span><span class="o">=</span><span class="n">file_names</span><span class="p">,</span>
    <span class="n">search_replace_dict</span><span class="o">=</span><span class="n">search_replace_dict</span><span class="p">,</span>
    <span class="n">suffix_dict</span><span class="o">=</span><span class="n">suffix_dict</span>
<span class="p">)</span>

<span class="c1"># Step 6: Clean and prepare the soil data (e.g., remove outliers, fill NaNs)</span>
<span class="n">gsde</span><span class="o">.</span><span class="n">fill_and_clean_data</span><span class="p">()</span>

<span class="c1"># Step 7: Define soil profile intervals for GSDE and MESH (depths in meters)</span>
<span class="n">gsde_intervals</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.045</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.045</span><span class="p">,</span> <span class="mf">0.091</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.091</span><span class="p">,</span> <span class="mf">0.166</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.166</span><span class="p">,</span> <span class="mf">0.289</span><span class="p">),</span>
                  <span class="p">(</span><span class="mf">0.289</span><span class="p">,</span> <span class="mf">0.493</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.493</span><span class="p">,</span> <span class="mf">0.829</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.829</span><span class="p">,</span> <span class="mf">1.383</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.383</span><span class="p">,</span> <span class="mf">2.296</span><span class="p">)]</span>

<span class="n">mesh_intervals</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">)]</span>

<span class="n">gsde</span><span class="o">.</span><span class="n">calculate_weights</span><span class="p">(</span><span class="n">gsde_intervals</span><span class="p">,</span> <span class="n">mesh_intervals</span><span class="p">)</span>

<span class="c1"># Step 8: Compute mesh-compatible weighted averages of soil properties</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;CLAY&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CLAY1&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY2&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY3&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY4&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY5&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY6&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY7&#39;</span><span class="p">,</span> <span class="s1">&#39;CLAY8&#39;</span><span class="p">],</span>
    <span class="s1">&#39;SAND&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SAND1&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND2&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND3&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND4&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND5&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND6&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND7&#39;</span><span class="p">,</span> <span class="s1">&#39;SAND8&#39;</span><span class="p">],</span>
    <span class="s1">&#39;OC&#39;</span><span class="p">:</span>   <span class="p">[</span><span class="s1">&#39;OC1&#39;</span><span class="p">,</span> <span class="s1">&#39;OC2&#39;</span><span class="p">,</span> <span class="s1">&#39;OC3&#39;</span><span class="p">,</span> <span class="s1">&#39;OC4&#39;</span><span class="p">,</span> <span class="s1">&#39;OC5&#39;</span><span class="p">,</span> <span class="s1">&#39;OC6&#39;</span><span class="p">,</span> <span class="s1">&#39;OC7&#39;</span><span class="p">,</span> <span class="s1">&#39;OC8&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">gsde</span><span class="o">.</span><span class="n">calculate_mesh_values</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span>

<span class="c1"># Step 9: Merge processed soil data into the basin shapefile and save output</span>
<span class="n">gsde</span><span class="o">.</span><span class="n">merge_and_save_shapefile</span><span class="p">()</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.gsde_soil.</span></span><span class="sig-name descname"><span class="pre">GSDESoil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_basin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_shapefile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gsde_soil.html#GSDESoil"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to process, clean, interpolate, and merge soil property data from CSV files
with a given basin shapefile, producing model-ready soil inputs.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">directory</span></span></dt>
<dd><p>Directory containing input CSV files with soil properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">input_basin</span></span></dt>
<dd><p>Path to the input basin shapefile with a ‘COMID’ identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">output_shapefile</span></span></dt>
<dd><p>Path to the output shapefile with processed soil attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">file_paths</span></span></dt>
<dd><p>List of full file paths for input CSVs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">gsde_df</span></span></dt>
<dd><p>Combined soil property table after processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">merged_gdf</span></span></dt>
<dd><p>Final spatial dataset with soil properties merged to polygons.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>geopandas.GeoDataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">weights_used</span></span></dt>
<dd><p>Weights used to interpolate soil layers into mesh layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mesh_intervals</span></span></dt>
<dd><p>Target depth intervals used for model input (e.g., MESH layers).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">lon</span></span></dt>
<dd><p>Longitude values loaded from a NetCDF drainage database.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">lat</span></span></dt>
<dd><p>Latitude values loaded from a NetCDF drainage database.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">segid</span></span></dt>
<dd><p>Segment IDs (e.g., subbasin or COMID) from a drainage database.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">num_soil_lyrs</span></span></dt>
<dd><p>Number of output mesh layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">calculate_mesh_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gsde_soil.html#GSDESoil.calculate_mesh_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply the calculated weights to soil property columns and generate
epth-integrated values for each mesh layer.</p>
<section id="id20">
<h3>Parameters:<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>column_names<span class="classifier">dict</span></dt><dd><p>Dictionary mapping each property (e.g., “CLAY”, “OC”) to its source columns.
Example: {‘CLAY’: [‘CLAY1’, ‘CLAY2’, …], ‘OC’: [‘OC1’, ‘OC2’, …]}</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">calculate_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gsde_intervals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_intervals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gsde_soil.html#GSDESoil.calculate_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate the contribution weights from each GSDE layer to each model-defined
mesh layer based on depth intervals.</p>
<section id="id21">
<h3>Parameters:<a class="headerlink" href="#id21" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>gsde_intervals<span class="classifier">list of tuple</span></dt><dd><p>List of tuples representing GSDE depth layers (e.g., [(0, 0.045), …]).</p>
</dd>
<dt>mesh_intervals<span class="classifier">list of tuple</span></dt><dd><p>Target model layer depths (e.g., [(0, 0.1), (0.1, 0.35), …]).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">fill_and_clean_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exclude_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['COMID']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_patterns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['OC',</span> <span class="pre">'BD',</span> <span class="pre">'BDRICM',</span> <span class="pre">'BDTICM']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gsde_soil.html#GSDESoil.fill_and_clean_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Clean the soil data by:
- Replacing extreme values with NaN (based on max_val).
- Normalizing and capping specific fields (e.g., BDRICM/BDTICM).
- Filling missing values using forward and backward fill.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exclude_cols</strong> (<em>list</em><em> of </em><em>str</em>) – Columns to exclude from NaN replacement.</p></li>
<li><p><strong>exclude_patterns</strong> (<em>list</em><em> of </em><em>str</em>) – Column name substrings to skip when applying value caps.</p></li>
<li><p><strong>max_val</strong> (<em>float</em>) – Maximum valid threshold for general soil values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_and_merge_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_replace_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'COMID'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gsde_soil.html#GSDESoil.load_and_merge_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Load multiple CSV files and merge them on a common key. Renames and suffixes
column names as needed during the loading process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_list</strong> (<em>list</em><em> of </em><em>str</em>) – List of full CSV file paths.</p></li>
<li><p><strong>search_replace_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Column renaming instructions for each file.</p></li>
<li><p><strong>suffix_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Suffix strings to append to column names by file.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – Primary key used to merge all data files (default is ‘COMID’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Merged DataFrame containing columns from all input files.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_replace_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gsde_soil.html#GSDESoil.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Load and merge multiple CSV files into a single DataFrame. Optionally apply
search-and-replace logic and suffixes to column names to ensure compatibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_names</strong> (<em>list</em><em> of </em><em>str</em>) – List of filenames to load from the given directory.</p></li>
<li><p><strong>search_replace_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary where keys are filenames and values are (search_list, replace_list) tuples
used to rename columns (e.g., depth labels to CLAY1, CLAY2, etc.).</p></li>
<li><p><strong>suffix_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary where keys are filenames and values are suffix strings
to append to column names (useful for distinguishing overlapping variables).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">merge_and_save_shapefile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gsde_soil.html#GSDESoil.merge_and_save_shapefile"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Merge the processed soil data (via COMID) into the input shapefile and save the result.
Output is a GeoDataFrame with mesh values appended as new attributes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">set_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ddb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/gsde_soil.html#GSDESoil.set_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Set longitude and latitude values from a NetCDF drainage database.</p>
<section id="id22">
<h3>Parameters:<a class="headerlink" href="#id22" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>input_ddb<span class="classifier">str</span></dt><dd><p>Path to the NetCDF drainage database file.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="module-MESHpyPreProcessing.remap_climate_to_ddb">
<span id="meshpypreprocessing-remap-climate-to-ddb-module"></span><h2>MESHpyPreProcessing.remap_climate_to_ddb module<a class="headerlink" href="#module-MESHpyPreProcessing.remap_climate_to_ddb" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.remap_climate_to_ddb.process_file">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.remap_climate_to_ddb.</span></span><span class="sig-name descname"><span class="pre">process_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/remap_climate_to_ddb.html#process_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.remap_climate_to_ddb.process_file" title="Link to this definition"></a></dt>
<dd><p>Process a single NetCDF file and remap its data to the drainage database (DDB) format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – Path to the input NetCDF file.</p></li>
<li><p><strong>segid</strong> (<em>numpy.ndarray</em>) – Array of subbasin IDs from the drainage database.</p></li>
<li><p><strong>lon</strong> (<em>numpy.ndarray</em>) – Array of longitude values from the drainage database.</p></li>
<li><p><strong>lat</strong> (<em>numpy.ndarray</em>) – Array of latitude values from the drainage database.</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – Path to the directory where the processed file will be saved.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">remap_climate_to_ddb</span><span class="w"> </span><span class="kn">import</span> <span class="n">process_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">process_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;path/to/input.nc&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">segid</span><span class="o">=</span><span class="n">subbasin_ids</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">lon</span><span class="o">=</span><span class="n">longitudes</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">lat</span><span class="o">=</span><span class="n">latitudes</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;path/to/output&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.remap_climate_to_ddb.remap_rdrs_climate_data">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.remap_climate_to_ddb.</span></span><span class="sig-name descname"><span class="pre">remap_rdrs_climate_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_basin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_ddb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/remap_climate_to_ddb.html#remap_rdrs_climate_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.remap_climate_to_ddb.remap_rdrs_climate_data" title="Link to this definition"></a></dt>
<dd><p>Remap RDRS climate data to a drainage database (DDB) format for a range of years.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_directory</strong> (<em>str</em>) – Path to the directory containing input NetCDF files.</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – Path to the directory where processed files will be saved.</p></li>
<li><p><strong>input_basin</strong> (<em>str</em>) – Path to the basin shapefile.</p></li>
<li><p><strong>input_ddb</strong> (<em>str</em>) – Path to the drainage database NetCDF file.</p></li>
<li><p><strong>start_year</strong> (<em>int</em>) – Start year of the data to process.</p></li>
<li><p><strong>end_year</strong> (<em>int</em>) – End year of the data to process.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">remap_climate_to_ddb</span><span class="w"> </span><span class="kn">import</span> <span class="n">remap_rdrs_climate_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">remap_rdrs_climate_data</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_directory</span><span class="o">=</span><span class="s2">&quot;path/to/input&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;path/to/output&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">input_basin</span><span class="o">=</span><span class="s2">&quot;path/to/basin.shp&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">input_ddb</span><span class="o">=</span><span class="s2">&quot;path/to/ddb.nc&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">start_year</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">end_year</span><span class="o">=</span><span class="mi">2020</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MESHpyPreProcessing.remap_climate_to_ddb.remap_rdrs_climate_data_single_year">
<span class="sig-prename descclassname"><span class="pre">MESHpyPreProcessing.remap_climate_to_ddb.</span></span><span class="sig-name descname"><span class="pre">remap_rdrs_climate_data_single_year</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_basin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_ddb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MESHpyPreProcessing/remap_climate_to_ddb.html#remap_rdrs_climate_data_single_year"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MESHpyPreProcessing.remap_climate_to_ddb.remap_rdrs_climate_data_single_year" title="Link to this definition"></a></dt>
<dd><p>Remap RDRS climate data to a drainage database (DDB) format for a single year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_directory</strong> (<em>str</em>) – Path to the directory containing input NetCDF files.</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – Path to the directory where processed files will be saved.</p></li>
<li><p><strong>input_basin</strong> (<em>str</em>) – Path to the basin shapefile.</p></li>
<li><p><strong>input_ddb</strong> (<em>str</em>) – Path to the drainage database NetCDF file.</p></li>
<li><p><strong>year</strong> (<em>int</em>) – Year of the data to process.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">remap_climate_to_ddb</span><span class="w"> </span><span class="kn">import</span> <span class="n">remap_rdrs_climate_data_single_year</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">remap_rdrs_climate_data_single_year</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_directory</span><span class="o">=</span><span class="s2">&quot;path/to/input&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;path/to/output&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">input_basin</span><span class="o">=</span><span class="s2">&quot;path/to/basin.shp&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">input_ddb</span><span class="o">=</span><span class="s2">&quot;path/to/ddb.nc&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">year</span><span class="o">=</span><span class="mi">2020</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-MESHpyPreProcessing">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-MESHpyPreProcessing" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="MESHpyPostProcessing.html" class="btn btn-neutral float-right" title="MESHpyPostProcessing package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Fuad Yassin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>